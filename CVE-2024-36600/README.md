# CVE-2024-36600: Buffer Overflow in libcdio

The GNU Compact Disc Input and Control library (libcdio) contains a library for CD-ROM and CD image access. Applications wishing to be oblivious of the OS- and device-dependent properties of a CD-ROM or of the specific details of various CD-image formats may benefit from using this library.

I did my best to help make this popular library more secure. To that end, I voluntarily submitted patches to address vulnerabilities to the library's respected developer.

**Vulnerability Description:**
The length of the buffer allocated for the UTF-8 filename string is the same as the length of the UCS-2 string (which means it can store twice as many UTF-8 bytes as there are characters in the filename). However, it is still possible for the converted UTF-8 string to overflow this buffer if the filename contains glyphs that use 3 or 4-byte UTF-8 sequences. This is because a single character in the filename may be represented by a multi-byte UTF-8 sequence, and the total number of bytes required for the UTF-8 representation could exceed the allocated buffer size, even though the number of characters is the same as the UCS-2 string.

**Vulnerability:**
Buffer OverFlow Vulnerability in libcdio v2.1.0 allows an attacker to execute arbitrary code via a crafted ISO 9660 image file.

**PoC:**
It is located in this part. (PoC-libcdio-bof.iso)



Discovered by Mansour Gashasbi, May 2024.

**More Information:**

- https://git.savannah.gnu.org/cgit/libcdio.git/tree/lib/iso9660/iso9660_fs.c#n814

- https://git.savannah.gnu.org/cgit/libcdio.git/log/?h=mansour-gashasbi-patches

- https://git.savannah.gnu.org/cgit/libcdio.git/tree/THANKS


**References:**

- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-36600

- https://nvd.nist.gov/vuln/detail/CVE-2024-36600